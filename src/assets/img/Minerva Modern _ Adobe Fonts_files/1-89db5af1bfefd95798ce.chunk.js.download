(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{1384:function(e,t,n){window.loadImage=n(1385);var r=n(1),i=n(54);e.exports={downsample:function(e,t,n,a,o){var s=i.getData("/visual_search/i18n");if(!r.includes(n,e.type))return void o({metric:{name:"typekit.render.visual-search.error-message",value:{error:"format",format:e.type}},errorMessage:s.image_downsampler.file_format_not_supported});window.loadImage(e,(function(n){if("error"!==n.type){var r=n.toDataURL(e.type);(function(e){return Math.round(3*e.length/4)})(r)>t?o({metric:{name:"typekit.render.visual-search.error-message",value:{error:"size",size:e.size}},errorMessage:s.image_downsampler.file_is_too_large}):a(r,e.name)}else o({metric:{name:"typekit.render.visual-search.error-message",value:{error:"unprocessable"}},errorMessage:s.image_downsampler.file_could_not_be_processed})}),{pixelRatio:1,downsamplingRatio:.5,maxWidth:4e3,maxHeight:4e3,minWidth:1,minHeight:1,canvas:!0,orientation:!0})}}},342:function(e,t,n){var r,i=n(1384),a=n(54),o=null,s="visual-search-drag-and-drop-form",l="drop-file-here__upload",d=".visual-search-file-input",c=["image/gif","image/jpeg","image/jpg","image/png"],u=XMLHttpRequest.DONE||4;function m(){var e,t;(r=a.getData("/visual_search/i18n"),w())&&(y(w()).addEventListener("change",E),window.addEventListener("dragenter",I),window.addEventListener("dragleave",q),window.addEventListener("dragover",x),window.addEventListener("drop",H),e=[document.getElementById("drop-file-here__link"),document.getElementById("try-a-visual-search")],(t=e.filter((function(e){return e}))).forEach((function(e){e.addEventListener("click",k)})),t.length>0&&document.getElementById(l).querySelector(d).addEventListener("change",E),document.body.appendChild(g()),f().addEventListener("click",L),_()&&_().addEventListener("change",E))}function f(){return g().getElementsByClassName("visual-search-drop-zone__close")[0]}function g(){return function(){if(null===document.getElementById("drop-file-here-fullscreen"))return;var e=document.getElementById(s).getBoundingClientRect();e.top<0||e.bottom>(window.innerHeight||document.documentElement.clientHeight)?(document.getElementById("drop-file-here-fullscreen_frame").classList.add("visual-search-fullscreen__frame"),document.getElementById("drop-file-here-fullscreen").classList.remove("drop-file-here__drop-zone"),document.getElementById("drop-file-here").classList.remove("drop-file-here__small")):(document.getElementById("drop-file-here-fullscreen_frame").classList.remove("visual-search-fullscreen__frame"),document.getElementById("drop-file-here-fullscreen").classList.add("drop-file-here__drop-zone"),document.getElementById("drop-file-here").classList.add("drop-file-here__small"))}(),document.getElementById(s)}function p(){return g().querySelector(".visual-search-drop-zone")}function v(){return document.getElementsByClassName("visual-search-error__text")[0]}function h(){return document.getElementsByClassName("visual-search-error__details")[0]}function y(e){return e.querySelector(d)}function _(){return document.getElementById("upload-another-file-input")}function w(){return document.querySelector("#visual-search-upload-form")}function L(){S()}function E(e){b("typekit.click.visual-search.browse-select-image"),z(y(e.target.form).files[0])}function k(){document.getElementById("visual-search-file-input-drag-and-drop").click()}function B(e){e.metric&&b(e.metric.name,e.metric.value),e.errorMessage&&R(e.errorMessage.text,e.errorMessage.details)}function T(e,t,n){var i=new XMLHttpRequest;i.onreadystatechange=function(){i.readyState===u&&200===i.status?i.responseText.trim()?t(JSON.parse(i.responseText)):t():i.readyState===u&&200!==i.status&&R(r.visual_search.something_went_wrong.text,r.visual_search.something_went_wrong.details)},f().addEventListener("click",(function(){var e;(e=i).onreadystatechange=null,e.abort()})),i.open("POST",e,!0),i.setRequestHeader("Content-Type","application/json"),i.setRequestHeader("X-CSRF-Token",function(){for(var e=document.getElementsByTagName("meta"),t=0;t<e.length;t++)if("csrf-token"==e[t].getAttribute("name"))return e[t].getAttribute("content")}()),i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.send(n)}function I(e){if(function(e){for(var t=e.dataTransfer,n=0;n<t.types.length;n++)if("Files"===t.types[n])return!0;return!1}(e)){o=e.target;var t=p();M(g()),t.querySelector(".filename").innerText="",t.classList.remove("loading"),t.classList.add("active")}}function q(e){e.preventDefault(),e.target===o&&S()}function x(e){e.preventDefault(),e.stopPropagation()}function H(e){if(e.preventDefault(),b("typekit.click.visual-search.drop-image"),1==e.dataTransfer.files.length){var t=e.dataTransfer.files[0];p().classList.remove("active"),window.setTimeout((function(){z(t)}),1)}else e.dataTransfer.files.length>1&&R(r.visual_search.uploading_multiple_files.text,r.visual_search.uploading_multiple_files.details)}function M(e){e.style.display="block"}function R(e,t){p().classList.remove("loading"),p().classList.add("active"),document.querySelector(".filename").innerText="",v().innerHTML=e,h().innerHTML=t}function S(){g().style.display="none",C();var e=p();e.classList.add("loading"),e.classList.remove("active"),e.querySelector(".filename").innerText=""}function b(e,t){window.newrelic&&"undefined"!==typeof window.newrelic&&window.newrelic.addPageAction(e,t||{})}function z(e){C(),function(e){M(g());var t=p();t.classList.add("loading"),t.querySelector(".filename").innerText=e.name}(e),i.downsample(e,5242880,c,(function(t,n){!function(e,t){var n=window.URL||window.webkitURL,r=new Image;r.onload=function(){t({width:this.naturalWidth,height:this.naturalHeight,size:e.size,format:e.type})},r.src=n.createObjectURL(e)}(e,(function(e){b("typekit.click.visual-search.upload-image",e)})),T(document.getElementById(s).action+".json",(function(e){window.location.href=e.path}),JSON.stringify({image_string:t,image_file_name:n}))}),B)}function C(){v().innerHTML="",h().innerHTML=""}e.exports={init:function(){"loading"!=document.readyState?m():document.addEventListener("DOMContentLoaded",m)}}}}]);
//# sourceMappingURL=1-89db5af1bfefd95798ce.chunk.js.map